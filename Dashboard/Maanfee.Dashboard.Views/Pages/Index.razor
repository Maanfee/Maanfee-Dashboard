@using Maanfee.Dashboard.Examples.Views.Pages.Booklets
@using Maanfee.Web.Printing
@using Microsoft.AspNetCore.Http
@using System.Reflection
@page "/"
@inherits _BaseView

<MaanfeeDashboardPage>
    <MaanfeeDashboardPageHeader PageTitle="@DashboardResource.StringDashboard" />

    <MudGrid>
        <MudItem md="12" xs="12">
            <MudAlert Severity="Severity.Success" ContentAlignment="HorizontalAlignment.Start">
                @ApplicationResource.StringWelcomeMessage
            </MudAlert>
        </MudItem>
        <MudItem md="4">
            <MaanfeeDashboardTile Title="Online Users" Value="-50" Color="Color.Primary" ChartClass="mud-primary" Icon="@Icons.Material.Filled.TrendingDown" Description="Description" />
        </MudItem>
        <MudItem md="4">
            <MaanfeeDashboardTile Title="Active Users" Value="200" Color="Color.Secondary" ChartClass="mud-secondary" Icon="@Icons.Material.Filled.TrendingUp" Description="Description" />
        </MudItem>
        <MudItem md="4">
            <MaanfeeDashboardTile Title="Deleted Users" Value="250" Color="Color.Tertiary" ChartClass="mud-tertiary" Icon="@Icons.Material.Filled.TrendingFlat" Description="Description" />
        </MudItem>
        <MudItem md="3">
            <MaanfeeDashboardExploreCard Title="Colors" HoverTypo="MaanfeeDashboardExploreCard.HoverType.Type1" Link="/features/colors">
                <div style="width:50px;height:50px" class="relative mb-n6 ml-n8 justify-center align-center">
                    <MudPaper Elevation="25" Height="68px" Width="24px" Class="mud-theme-dark absolute" Style="bottom:0;left: 0; transform: rotate(0deg);transform-origin: bottom center;" />
                    <MudPaper Elevation="25" Height="68px" Width="24px" Class="mud-theme-tertiary absolute" Style="bottom:0;left: 0; transform: rotate(30deg);transform-origin: bottom center;" />
                    <MudPaper Elevation="25" Height="68px" Width="24px" Class="mud-theme-secondary absolute" Style="bottom:0;left: 0; transform: rotate(60deg);transform-origin: bottom center;" />
                    <MudPaper Elevation="25" Height="68px" Width="24px" Class="mud-theme-primary d-flex justify-center align-end absolute" Style="bottom:0;left: 0; transform: rotate(90deg);transform-origin: bottom center;">
                        <MudPaper Elevation="0" Height="8px" Width="8px" Class="rounded-circle ma-2" />
                    </MudPaper>
                </div>
            </MaanfeeDashboardExploreCard>
        </MudItem>
        <MudItem md="3">
            <MaanfeeDashboardExploreCard Title="Colors" HoverTypo="MaanfeeDashboardExploreCard.HoverType.Type2" Link="/features/colors">
                <div style="width:50px;height:50px" class="relative mb-n6 ml-n8 justify-center align-center">
                    <MudIcon Icon="@Icons.Material.Filled.TextFields" Color="Color.Primary" Style="font-size:84px;" />
                </div>
            </MaanfeeDashboardExploreCard>
        </MudItem>
        <MudItem md="6">
            <MaanfeeDashboardButtonCard Title="Colors">
                @*  <div style="width:50px;height:50px" class="relative mb-n6 ml-n8 justify-center align-center">
                <MudIcon Icon="@Icons.Material.Filled.TextFields" Color="Color.Primary" Style="font-size:84px;" />
                </div> *@
            </MaanfeeDashboardButtonCard>
        </MudItem>

        <MudItem md="12" xs="12">
            @*	<MudButton OnClick="@((e) => OpenDialog(fullScreen))" Variant="Variant.Filled" Color="Color.Secondary">
            کتابی
            </MudButton>

            @code {

            private DialogOptions fullScreen = new DialogOptions()
            {
            FullScreen = true,
            CloseButton = true,
            NoHeader = true,
            CloseOnEscapeKey = true,
            };

            private void OpenDialog(DialogOptions options)
            {
            Dialog.Show<BookletComponent>(string.Empty, options);
            }

            }
            *@
        </MudItem>
        <MudItem md="12" xs="12">
            @*	@Http.BaseAddress.AbsoluteUri*@
        </MudItem>
        <MudItem md="12" xs="12">
            @*@Http.BaseAddress.DnsSafeHost | @Http.BaseAddress.Host | @Http.BaseAddress.Port | @Http.BaseAddress.Scheme*@
        </MudItem>
        <MudItem md="12" xs="12">
            @*<img src="/StaticFiles/Profile/AAA/BBB/red-rose.jpg" />*@
        </MudItem>
    </MudGrid>

</MaanfeeDashboardPage>

@code {

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        try
        {
            var Callback = await Http.GetFromJsonAsync<CallbackResult<SysRelease>>($"api/SysReleases/GetLatestRelease");

            if (Callback.Data != null)
            {
                if (string.Compare(Callback.Data.Version, SharedLayoutSettings.CurrentVersion) > 0)
                {
                    DialogParameters parameters = new DialogParameters();
                    parameters.Add("SysRelease", Callback.Data);

                    var dialog = Dialog.Show<Settings.SysReleases.DialogReleaseControl>(string.Empty, parameters,
                        new DialogOptions()
                            {
                                NoHeader = true,
                                MaxWidth = MaxWidth.Medium,
                                FullWidth = true,
                                Position = DialogPosition.Center,
                                DisableBackdropClick = true,
                            });
                }
            }
            else
            {
                Snackbar.Add(Callback.Error.ToString(), Severity.Error);
            }
        }
        catch (Exception ex)
        {
            Snackbar.Add($"{DashboardResource.StringError} : " + ex.Message, Severity.Error);
        }
    }

}
